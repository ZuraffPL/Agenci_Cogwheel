<form class="{{cssClass}}" autocomplete="off">
  <header class="sheet-header">
    <img class="profile-img" src="{{actor.img}}" data-edit="img" title="{{localize 'COGSYNDICATE.EditImage'}}" />
    <h1><input name="name" type="text" value="{{actor.name}}" placeholder="{{localize 'COGSYNDICATE.CharacterName'}}" class="centered" /></h1>
  </header>

  <section class="sheet-body">
    <!-- Nawigacja tabów -->
    <nav class="sheet-tabs tabs" data-group="primary">
      <a class="item active" data-tab="core">{{localize "COGSYNDICATE.CoreTab"}}</a>
      <a class="item" data-tab="feats">{{localize "COGSYNDICATE.FeatsTab"}}</a>
      <a class="item" data-tab="equipment">{{localize "COGSYNDICATE.EquipmentTab"}}</a>
      <a class="item" data-tab="traumas">{{localize "COGSYNDICATE.TraumasTab"}}</a>
      <a class="item" data-tab="development">{{localize "COGSYNDICATE.DevelopmentTab"}}</a>
      <a class="item" data-tab="notes">{{localize "COGSYNDICATE.NotesTab"}}</a>
    </nav>

    <!-- Zawartość tabów -->
    <section class="sheet-content">
      <!-- Zakładka Core (domyślna) -->
      <div class="tab core active" data-group="primary" data-tab="core">
        <!-- Archetyp -->
        <div class="archetype-section">
          <h3 class="centered">{{localize "COGSYNDICATE.Archetype"}}</h3>
          <div class="archetype-drop" data-type="archetype">
            {{#if system.archetype.name}}
              <div class="archetype-info-left">
                <span class="archetype-name">{{system.archetype.name}}</span>
              </div>
              <div class="archetype-info-center">
                <div class="archetype-attributes">
                  <div class="archetype-attributes-header">{{localize "COGSYNDICATE.StartingAttributeValues"}}</div>
                  <div class="archetype-attributes-values">
                    {{#each system.archetype.attributes as |attr key|~}}{{localize (concat "COGSYNDICATE." (capitalize key))}}: {{attr}}{{#unless @last}} | {{/unless}}{{~/each}}
                  </div>
                </div>
              </div>
              <div class="archetype-info-right">
                <button type="button" class="remove-archetype" title="{{localize 'COGSYNDICATE.RemoveArchetype'}}"><i class="fas fa-trash"></i></button>
              </div>
            {{else}}
              <div class="archetype-info-center">
                <span>{{localize "COGSYNDICATE.ArchetypeDrop"}}</span>
              </div>
            {{/if}}
          </div>
        </div>

        <!-- Atrybuty Główne -->
        <div class="main-attributes columns">
          <h3 class="centered">{{localize "COGSYNDICATE.MainAttributes"}}</h3>
          <div class="attributes-container">
            <div class="attribute">
              <label>{{localize "COGSYNDICATE.Machine"}}</label>
              <div class="attribute-content">
                <input type="number" class="base-value" name="system.attributes.machine.base" value="{{system.attributes.machine.base}}" min="1" max="6" step="1" {{#unless editable}}disabled{{/unless}} title="{{localize 'COGSYNDICATE.BaseValueTooltipV2'}}" />
                <input type="number" class="effective-value" name="system.attributes.machine.value" value="{{effectiveAttributes.machine}}" min="0" max="6" readonly title="{{localize 'COGSYNDICATE.EffectiveValueTooltipV2'}}" />
                <button type="button" class="roll-attribute roll-btn" data-attribute="machine" title="{{localize 'COGSYNDICATE.Roll2d12'}}"><i class="fas fa-dice-d12"></i></button>
              </div>
              <!-- Obrażenia dla Steel -->
              <div class="damage-section">
                <label class="damage-label">{{localize "COGSYNDICATE.Damage"}}</label>
                <div class="damage-radio-group" data-attribute="machine">
                  {{#times system.attributes.machine.base}}
                    <div class="damage-radio-item">
                      <input type="radio" id="machine-damage-{{this}}" name="system.attributes.machine.damage" value="{{this}}" {{#if (eq ../system.attributes.machine.damage this)}}checked{{/if}}>
                      <label for="machine-damage-{{this}}">{{#if (eq this 0)}}0{{else}}-{{this}}{{/if}}</label>
                    </div>
                  {{/times}}
                </div>
              </div>
            </div>
            <div class="attribute">
              <label>{{localize "COGSYNDICATE.Engineering"}}</label>
              <div class="attribute-content">
                <input type="number" class="base-value" name="system.attributes.engineering.base" value="{{system.attributes.engineering.base}}" min="1" max="6" step="1" {{#unless editable}}disabled{{/unless}} title="{{localize 'COGSYNDICATE.BaseValueTooltipV2'}}" />
                <input type="number" class="effective-value" name="system.attributes.engineering.value" value="{{effectiveAttributes.engineering}}" min="0" max="6" readonly title="{{localize 'COGSYNDICATE.EffectiveValueTooltipV2'}}" />
                <button type="button" class="roll-attribute roll-btn" data-attribute="engineering" title="{{localize 'COGSYNDICATE.Roll2d12'}}"><i class="fas fa-dice-d12"></i></button>
              </div>
              <!-- Obrażenia dla Machine -->
              <div class="damage-section">
                <label class="damage-label">{{localize "COGSYNDICATE.Damage"}}</label>
                <div class="damage-radio-group" data-attribute="engineering">
                  {{#times system.attributes.engineering.base}}
                    <div class="damage-radio-item">
                      <input type="radio" id="engineering-damage-{{this}}" name="system.attributes.engineering.damage" value="{{this}}" {{#if (eq ../system.attributes.engineering.damage this)}}checked{{/if}}>
                      <label for="engineering-damage-{{this}}">{{#if (eq this 0)}}0{{else}}-{{this}}{{/if}}</label>
                    </div>
                  {{/times}}
                </div>
              </div>
            </div>
            <div class="attribute">
              <label>{{localize "COGSYNDICATE.Intrigue"}}</label>
              <div class="attribute-content">
                <input type="number" class="base-value" name="system.attributes.intrigue.base" value="{{system.attributes.intrigue.base}}" min="1" max="6" step="1" {{#unless editable}}disabled{{/unless}} title="{{localize 'COGSYNDICATE.BaseValueTooltipV2'}}" />
                <input type="number" class="effective-value" name="system.attributes.intrigue.value" value="{{effectiveAttributes.intrigue}}" min="0" max="6" readonly title="{{localize 'COGSYNDICATE.EffectiveValueTooltipV2'}}" />
                <button type="button" class="roll-attribute roll-btn" data-attribute="intrigue" title="{{localize 'COGSYNDICATE.Roll2d12'}}"><i class="fas fa-dice-d12"></i></button>
              </div>
              <!-- Obrażenia dla Intrigue -->
              <div class="damage-section">
                <label class="damage-label">{{localize "COGSYNDICATE.Damage"}}</label>
                <div class="damage-radio-group" data-attribute="intrigue">
                  {{#times system.attributes.intrigue.base}}
                    <div class="damage-radio-item">
                      <input type="radio" id="intrigue-damage-{{this}}" name="system.attributes.intrigue.damage" value="{{this}}" {{#if (eq ../system.attributes.intrigue.damage this)}}checked{{/if}}>
                      <label for="intrigue-damage-{{this}}">{{#if (eq this 0)}}0{{else}}-{{this}}{{/if}}</label>
                    </div>
                  {{/times}}
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Zasoby Agenta -->
        <div class="agent-resources columns">
          <h3 class="centered">{{localize "COGSYNDICATE.AgentResources"}}</h3>
          <div class="resources-container">
            <div class="resource gear">
              <label><i class="fas fa-cog"></i> {{localize "COGSYNDICATE.Gear"}}</label>
              <div class="resource-content">
                <button type="button" class="decrement small-btn" data-resource="gear">-</button>
                <input type="number" class="gear-value" name="system.resources.gear.value" value="{{system.resources.gear.value}}" min="0" max="{{system.resources.gear.max}}" data-dtype="Number" title="{{localize 'COGSYNDICATE.GearTooltip' max=system.resources.gear.max}}" />
                <span>/ {{system.resources.gear.max}}</span>
                <button type="button" class="increment small-btn" data-resource="gear">+</button>
              </div>
              <div class="gear-basis">
                <label>{{localize "COGSYNDICATE.GearBasis"}}</label>
                <select name="system.resources.gear.basis" class="gear-basis-select">
                  <option value="machine" {{#if (eq system.resources.gear.basis "machine")}}selected{{/if}}>{{localize "COGSYNDICATE.Machine"}}</option>
                  <option value="engineering" {{#if (eq system.resources.gear.basis "engineering")}}selected{{/if}}>{{localize "COGSYNDICATE.Engineering"}}</option>
                </select>
              </div>
              <div class="gear-spend-section">
                <button type="button" class="spend-gear-btn">{{localize "COGSYNDICATE.SpendGear"}}</button>
              </div>
            </div>
            <div class="resource trauma">
              <label>{{localize "COGSYNDICATE.Trauma"}}</label>
              <div class="resource-content">
                <button type="button" class="decrement small-btn" data-resource="trauma">-</button>
                <input type="number" class="trauma-value" name="system.resources.trauma.value" value="{{system.resources.trauma.value}}" min="0" max="{{system.resources.trauma.max}}" data-dtype="Number" title="{{localize 'COGSYNDICATE.TraumaTooltip' max=system.resources.trauma.max}}" />
                <span>/ {{system.resources.trauma.max}}</span>
                <button type="button" class="increment small-btn" data-resource="trauma">+</button>
              </div>
            </div>
            <div class="resource stress">
             <label><i class="fas fa-exclamation-triangle"></i> {{localize "COGSYNDICATE.Stress"}}</label>
              <div class="resource-content">
                <button type="button" class="decrement small-btn" data-resource="stress">-</button>
                <input type="number" class="stress-value" name="system.resources.stress.value" value="{{system.resources.stress.value}}" min="0" max="{{system.resources.stress.max}}" data-dtype="Number" title="{{localize 'COGSYNDICATE.StressTooltip' max=system.resources.stress.max}}" />
                <span>/ {{system.resources.stress.max}}</span>
                <button type="button" class="increment small-btn" data-resource="stress">+</button>
              </div>
              <div class="stress-spend-section">
                <button type="button" class="spend-stress-btn">{{localize "COGSYNDICATE.SpendStress"}}</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Zakładka Atuty -->
      <div class="tab feats" data-group="primary" data-tab="feats">
        <div class="feats-section">
          <h3 class="centered">{{localize "COGSYNDICATE.FeatsTab"}}</h3>
          <div class="feats-drop" data-type="feat">
            {{#if (gt feats.length 0)}}
              {{#each feats as |feat|}}
                <div class="feat-item {{#if @odd}}feat-item-alt{{/if}}" data-item-id="{{feat.id}}">
                  <div class="feat-header-grid">
                    <div class="feat-col-toggle">
                      <button type="button" class="feat-toggle-btn" data-item-id="{{feat.id}}" title="{{localize 'COGSYNDICATE.ToggleFeatDetails'}}">
                        <i class="fas fa-plus"></i>
                      </button>
                    </div>
                    <div class="feat-col-name"><span class="feat-name">{{feat.name}}</span></div>
                    <div class="feat-col-type"><span class="feat-type">{{#if (eq feat.system.type "initial")}}{{localize "COGSYNDICATE.FeatInitial"}}{{else}}{{localize "COGSYNDICATE.FeatAdvanced"}}{{/if}}</span></div>
                    <div class="feat-col-delete"><button type="button" class="delete-feat small-btn" data-item-id="{{feat.id}}" title="{{localize 'COGSYNDICATE.DeleteFeat'}}"><i class="fas fa-trash"></i></button></div>
                  </div>
                  <div class="feat-details" style="display: none;">
                    {{#if feat.system.effect}}
                      <div class="feat-description">
                        <strong>{{localize "COGSYNDICATE.Description"}}:</strong> {{feat.system.effect}}
                      </div>
                    {{/if}}
                    {{#if feat.system.narrativeEffect}}
                      <div class="feat-narrative">
                        <strong>{{localize "COGSYNDICATE.NarrativeEffect"}}:</strong> {{feat.system.narrativeEffect}}
                      </div>
                    {{/if}}
                  </div>
                </div>
              {{/each}}
            {{else}}
              <div class="no-feats-message">
                <p>{{localize "COGSYNDICATE.FeatDrop"}}</p>
              </div>
            {{/if}}
          </div>
        </div>
      </div>

      <!-- Zakładka Ekwipunek -->
      <div class="tab equipment" data-group="primary" data-tab="equipment">
        <section class="equipment-section">
          <h2>{{localize "COGSYNDICATE.EquipmentTab"}}</h2>
          
          <!-- Licznik Punktów Ekwipunku -->
          <div class="equipment-points">
            <span class="equipment-points-label">{{localize "COGSYNDICATE.EquipmentPoints"}}:</span>
            <span class="equipment-points-value">{{system.equipmentPoints.value}}</span>
            <span class="equipment-points-max">/ {{system.equipmentPoints.max}}</span>
          </div>
          
          <button class="add-equipment-btn">{{localize "COGSYNDICATE.AddEquipment"}}</button>
            {{#each system.equipments as |equipment index|}}
              <div class="equipment-item {{#if (or equipment.used equipment.droppedDamaged equipment.destroyed)}}disabled{{/if}}" data-index="{{index}}">
                <div class="equipment-header">
                  {{equipment.name}} ({{localize (concat 'COGSYNDICATE.EquipmentType' (capitalize equipment.type))}})
                </div>
                <div class="equipment-details">
                  <div>
                    {{localize "COGSYNDICATE.EquipmentCost"}}: {{equipment.cost}}
                    <br>
                    {{localize "COGSYNDICATE.EquipmentAction"}}: {{equipment.action}}
                    <br>
                    {{localize "COGSYNDICATE.EquipmentUsage"}}: {{localize (concat 'COGSYNDICATE.EquipmentUsage' (capitalize equipment.usage))}}
                  </div>
                  <div class="equipment-actions">
                    <a class="edit-equipment"><i class="fas fa-edit"></i></a>
                    <a class="delete-equipment"><i class="fas fa-trash"></i></a>
                  </div>
                </div>
                <div class="equipment-status">
                  <label><input type="checkbox" class="equipment-status-checkbox" data-index="{{index}}" data-status="used" {{#if equipment.used}}checked{{/if}} /> {{localize "COGSYNDICATE.EquipmentUsed"}}</label>
                  <label><input type="checkbox" class="equipment-status-checkbox" data-index="{{index}}" data-status="droppedDamaged" {{#if equipment.droppedDamaged}}checked{{/if}} /> {{localize "COGSYNDICATE.EquipmentDroppedDamaged"}}</label>
                  <label><input type="checkbox" class="equipment-status-checkbox" data-index="{{index}}" data-status="destroyed" {{#if equipment.destroyed}}checked{{/if}} /> {{localize "COGSYNDICATE.EquipmentDestroyed"}}</label>
                </div>
              </div>
          {{/each}}
          {{#unless system.equipments.length}}
            {{localize "COGSYNDICATE.NoEquipmentToAdd"}}
          {{/unless}}
        </section>
      </div>

      <!-- Zakładka Traumy -->
      <div class="tab traumas" data-group="primary" data-tab="traumas">
        <div class="traumas-section">
          <h3 class="centered">{{localize "COGSYNDICATE.TraumasTab"}}</h3>
          <button type="button" class="add-trauma-btn" title="{{localize 'COGSYNDICATE.AddTrauma'}}">{{localize "COGSYNDICATE.AddTrauma"}}</button>
          <div class="traumas-list">
            {{#each system.traumas as |trauma index|}}
              <div class="trauma-item trauma-type-{{trauma.type}}" data-index="{{index}}">
               <div class="trauma-header">
                  <span class="trauma-name">{{trauma.name}}</span>
                  <span class="trauma-level">{{localize "COGSYNDICATE.TraumaLevel"}} {{inc index}}</span>
                  <span class="trauma-type-label">{{localize (concat "COGSYNDICATE.TraumaType" (capitalize trauma.type))}}</span>
                </div>
                <div class="trauma-details">
                 <span class="trauma-description">{{trauma.description}}</span>
                  <span class="trauma-effect">{{trauma.effect}}</span>
                </div>
                <div class="trauma-actions">
                  <button type="button" class="edit-trauma trauma-action-btn" title="{{localize 'COGSYNDICATE.EditTrauma'}}"><i class="fas fa-edit"></i></button>
                  <button type="button" class="delete-trauma trauma-action-btn" title="{{localize 'COGSYNDICATE.DeleteTrauma'}}"><i class="fas fa-trash"></i></button>
                </div>
              </div>
            {{/each}}
            {{#unless system.traumas.length}}
              <p>{{localize "COGSYNDICATE.TraumasPlaceholder"}}</p>
            {{/unless}}
         </div>
        </div>
      </div>

      <!-- Zakładka Rozwój -->
      <div class="tab development" data-group="primary" data-tab="development">
        <div class="development-section">
          <h3 class="centered">{{localize "COGSYNDICATE.Development"}}</h3>
          <div class="resources-container">
            <div class="resource development">
              <label>{{localize "COGSYNDICATE.DevelopmentPoints"}}</label>
              <div class="resource-content">
                <button type="button" class="decrement small-btn" data-resource="development">-</button>
                <input type="number" class="development-value" name="system.resources.development.value" value="{{system.resources.development.value}}" min="0" max="12" data-dtype="Number" title="{{localize 'COGSYNDICATE.DevelopmentPointsTooltip' max=system.resources.development.max}}" />
                <span>/ {{system.resources.development.max}}</span>
                <button type="button" class="increment small-btn" data-resource="development">+</button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Zakładka Notatki -->
      <div class="tab notes" data-group="primary" data-tab="notes">
        <div class="notes-section">
          <h3 class="centered">{{localize "COGSYNDICATE.NotesTab"}}</h3>
          <div class="notes-content">
            <textarea name="system.notes" class="notes-textarea" placeholder="{{localize 'COGSYNDICATE.NotesPlaceholder'}}">{{system.notes}}</textarea>
          </div>
        </div>
      </div>
    </section>
  </section>
</form>
